<!DOCTYPE html>
<html>
<head>
    <title>Pixel Pete in the Wild West</title>
<style type="text/css">

.backdrop{
    background-image: url(images/level_1_bg.jpg);
    position: absolute;
    top: 15px;
    bottom: 5px;
    left: 15px;
    right: 15px;
    border: 1px solid black;
    width: 1200px;
    height: 590px;
}

button{
    height: 100px;
    width: 150px;
    background-color: #FFFFFF;
}
#pete{
    
    position: absolute;
    background-image: url(images/pete_animated.png);
    top: 300px;
    left: 50px;
    width: 27px;
    height: 50px;
}

.ground{
    position: absolute;
    left: 0px;
    bottom: 0px;
    width: 1200px;
    height: 30px;
    background-image: url(images/ground.jpg);
}

div.gun1{
    height: 25px;
    width: 150px;
    position: absolute;
    background-image: url(images/lever_action.png);
    left: 750px;
    bottom: 278px;
}

.shotgun{

}

.rifle{

}

    .wallL {
        height: 95%;
        width: 1px;
        float: left;
        margin-left: 17px;
    }
    .wallR {
        height: 95%;
        width: 1px;
        float: right;
        margin-right: 17px;
    }

    .top {
        height: 1px;
        width: 100%;
        margin-bottom: 17px;
    }

    .ground .top{
        width: 100%;
    }

    .bottom {
        width: 100%;
        margin: 0 auto;
        height: 1px;
        clear: both;
        position: absolute;
        bottom: 0;
    }

.box1{
    position: absolute;
    bottom: 34px;
    left: 665px;
    width: 50px;
    height: 50px;
    /* padding-bottom: */
    background-image: url(images/box.jpg);
    background-repeat: no-repeat, repeat;
    background-size: 100%, auto;
}
.box2{
    position: absolute;
    bottom: 156px;
    left: 296px;
    width: 50px;
    height: 50px;
    /* padding-bottom: */
    background-image: url(images/box.jpg);
    background-repeat: no-repeat, repeat;
    background-size: 100%, auto;
}
.box3{
    position: absolute;
    bottom: 156px;
    left: 356px;
    width: 50px;
    height: 50px;
    /* padding-bottom: */
    background-image: url(images/box.jpg);
    background-repeat: no-repeat, repeat;
    background-size: 100%, auto;
}
.box4{
    position: absolute;
    bottom: 206px;
    left: 336px;
    width: 50px;
    height: 50px;
    /* padding-bottom: */
    background-image: url(images/box.jpg);
    background-repeat: no-repeat, repeat;
    background-size: 100%, auto;
}

.saloon-floor1{
    position: absolute;
    background-color: #37301d;
    height: 15px;
    width: 348px;
    left: 276px;
    bottom: 150px;
}
.saloon-floor2{
    position: absolute;
    background-color: #37301d;
    height: 15px;
    width: 148px;
    left: 786px;
    bottom: 150px;
}
.saloon-floor3{
    position: absolute;
    background-color: #37301d;
    height: 15px;
    width: 66px;
    left: 276px;
    bottom: 262px;
}
.saloon-floor4{
    position: absolute;
    background-color: #37301d;
    height: 15px;
    width: 490px;
    left: 442px;
    bottom: 262px;
}
.saloon-floor5{
    position: absolute;
    background-color: #37301d;
    height: 15px;
    width: 656px;
    left: 276px;
    bottom: 374px;
}

.saloon-wall1{
    position: absolute;
    background-color: #37301d;
    height: 268px;
    width: 15px;
    left: 282px;
    bottom: 112px;
}
.saloon-wall2{
    position: absolute;
    background-color: #37301d;
    height: 268px;
    width: 15px;
    left: 912px;
    bottom: 112px;
}

.boss1{
    background-color: red;
    position: absolute;
    right: 0;
    bottom: 30px;
    width: 50px;
    height: 80px;

}




</style>

</head>

    <!-- <div>
        <div class="wallL"></div>
        <div class="wallR"></div>
        <div class="top"></div>
        <div class="bottom"></div>
    </div> -->

    <!-- this is the blank template div for boxes and floors -->




<div class="battle-backdrop1">
    <div class="screen">
        <!--characters to be displayed here -->
    </div>
    <div class="ui">
        <button class="revolver"><p>ammo: <span>6</span></p></button>
        <button class="gun1"><p>ammo: <span>8</span></p></button>
        <button class="shotgun"><p>ammo: <span>4</span></p></button>
        <button class="rifle"><p>ammo: <span>1</span></p></button>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> 
<script type="text/javascript">
    
    
    const pete = $('#pete'),
          backdrop = $('.battle-backdrop1'),
          urlParam = getUrlVars()["weapons"];
    
          let weapons = urlParam.split('+');
          console.log(weapons);

          $('.ui button').each( function(){
            let button = $(this);
            console.log(button);
            let gunClass = button.attr('class')
            if(weapons.indexOf(gunClass) == -1){
                button.hide();
                console.log('not found')
            }else{
                console.log('found')
            }

          })



    let gameRunning = false,
        speed = 10,
        jumping = 0,
        leftspeed = 10,
        rightspeed = 10, //pixels per frame
        upspeed = 10,
        downspeed = 10, 
        //idea: put speeds in an object literal?
        pHeight = 50,
        pWidth = 27, 
        stageH = 590, 
        stageW = 1200, //we know the values for the player and the stage
        boss1HP = 100;

$('.ui button').on( 'click', function(e){
        const button = $(this); //the button that got clicked:
        let randomPerc = getRandInt(1,100), //gets the percent that the user generates
            revolverPerc = 65 > randomPerc, 
            //if 66 is less than randomPerc then revolverPerc is true
            gun1Perc = 80 > randomPerc,
            shotgunPerc = 40 > randomPerc,
            riflePerc = 95 > randomPerc,
            bClass = button.attr('class'),
            ammo = button.find('span').text()*1, //*1 converts string to number
            damage = 0;
            //console.log(ammo);
            ammo--;
            if(ammo == 0){
                $(this).off();
            }

            button.find('span').text(ammo);
        
            switch(bClass){
                case 'revolver':
                if(revolverPerc){
                    console.log('player hit');
                    damage = 35
                }else{
                    console.log('player miss');
                }
                //subtract ammo from box.
                break;

                case 'gun1':
                if(gun1Perc){
                    console.log('player hit');
                    //set damage
                    damage = 45;
                }else{
                    console.log('player miss');
                }
                //subtract ammo from box.
                break;
                //other potential guns go here and follow the same format:

                case 'shotgun':
                if(gun1Perc){
                    console.log('player hit');
                    //set damage
                    damage = 75;
                }else{
                    console.log('player miss');
                }
                //subtract ammo from box.
                break;

                case 'rifle':
                if(gun1Perc){
                    console.log('player hit');
                    //set damage
                    damage = 95;
                }else{
                    console.log('player miss');
                }
                //subtract ammo from box.
                break;
            } //end switch

             //which boss?
             boss1HP-=damage;
             console.log(boss1HP);
             if(boss1HP < 1){
                alert('You beat him!');
             }   
})

function getUrlVars() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        console.log(m);
        vars[key] = value;
  
    });
    //console.log(vars);
    return vars;
}



        //generate whole number:
        function getRandInt(min = 1, max = 100){
            //min and max have default values
            return Math.floor(Math.random() * (max - min) ) + min;
        }


</script>
</body>
</html>


